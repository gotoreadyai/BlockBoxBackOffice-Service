import{r as s,j as t}from"./vendor-D21JgsWP.js";import{U as e,a as o}from"./index-ClqwfEUu.js";import{A as n}from"./ActionMsg-CNHBAleQ.js";import{u as i}from"./useValidateScope-CzIszaus.js";const a=async(s,t)=>{const e=await fetch("http://localhost:3004/auth/signin",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:s,password:t})});if(!e.ok)throw new Error("Failed to sign in");const o=await e.json();return o.token&&((s,t)=>{const e=60*t*60;document.cookie=`auth_token=${s}; path=/; max-age=${e}; secure; samesite=strict`})(o.token,24),o},r=({scope:r,onActionResult:c,whitelist:m=["ownerId"]})=>{const{setUserToContext:u}=s.useContext(e),d=o((s=>s.setUser)),p=o((s=>s.setMainMessage)),{isValid:l}=i({scope:r,whitelist:m});return s.useEffect((()=>{(async()=>{if(l)try{const s=await a("admin@admin.com","admin");u(s.user),d(s.user),p("Sign In successful","success"),c(!0)}catch(s){p("Sign In error: "+r+s.message,"error"),c(!1)}else c(!1)})()}),[]),t.jsxs(n,{type:"info",children:["RUN: SignIn to: ",r]})};export{r as default};
