const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MainDashboard-C5kJiRXE.js","assets/react-ByP4G4OI.js","assets/ajv-Dq24E4CF.js","assets/fast-deep-equal-BfsdOM8n.js","assets/json-schema-traverse-CSPPDTu_.js","assets/fast-uri-DB0GTO5Q.js","assets/Layout2-BONwQNPK.js","assets/Header-YQw4_MKI.js","assets/Image-Dr8ugytS.js","assets/InputBlock-fyZlW53F.js","assets/react-dom-C5AsxZ0G.js","assets/scheduler-DhxmCZ7v.js","assets/react-router-dom-CMmNEzPH.js","assets/react-router-tydOGiMH.js","assets/@remix-run-BGIWjZ3f.js","assets/zustand-Djp2XC7l.js","assets/use-sync-external-store-HS-WvdAz.js","assets/@rjsf-Di5gDzcL.js","assets/lodash-C4siI3Fs.js","assets/json-schema-merge-allof-CAUJ1I2Z.js","assets/json-schema-compare-81NA3FRX.js","assets/compute-lcm-DluO9b7R.js","assets/compute-gcd-C3gVrxBz.js","assets/validate.io-array-K7AlgBFX.js","assets/validate.io-integer-array-CDpatKg4.js","assets/validate.io-integer-Dqa_6kz1.js","assets/validate.io-number-E8555gXQ.js","assets/validate.io-function-CsX-6D6V.js","assets/jsonpointer-CvFdTLoF.js","assets/react-is-BhM-FsKG.js","assets/nanoid-BV3C3NLD.js","assets/markdown-to-jsx-4MOCfVpk.js","assets/ajv-formats-B7rDf6Ua.js","assets/react-icons-LE4DYteI.js","assets/@tanstack-RoCisgU6.js","assets/uuid-aGgpFg1T.js","assets/@monaco-editor-Dg2g9lSe.js","assets/state-local-BC9ybJZH.js","assets/Link-BtfffzoU.js","assets/ListBlock-DsZq4ZjQ.js","assets/Logo-CIUzQXMf.js","assets/Paragraph-EPALh4Pu.js","assets/QueryBlock-oWiM60HW.js","assets/SubmitForm-CE8sSlml.js"])))=>i.map(i=>d[i]);
import{r as e,j as t,R as s}from"./react-ByP4G4OI.js";import{c as a}from"./react-dom-C5AsxZ0G.js";import{B as l}from"./react-router-dom-CMmNEzPH.js";import{r as o}from"./zustand-Djp2XC7l.js";import{g as r,F as n,v as i}from"./@rjsf-Di5gDzcL.js";import"./lodash-C4siI3Fs.js";import"./json-schema-merge-allof-CAUJ1I2Z.js";import"./jsonpointer-CvFdTLoF.js";import"./react-is-BhM-FsKG.js";import{F as c,a as d,b as m,c as u,d as p,e as b,L as h,f as j,g as x,h as g,i as f,j as v,k,l as y,m as N,n as S,o as w,p as C,q as E,r as _,s as B,t as L}from"./react-icons-LE4DYteI.js";import{a as P,b as D,d as O,e as T,f as F,g as I}from"./react-router-tydOGiMH.js";import{u as A,a as q,b as R,Q as $,c as M}from"./@tanstack-RoCisgU6.js";import{v as U}from"./uuid-aGgpFg1T.js";import{F as V}from"./@monaco-editor-Dg2g9lSe.js";import"./ajv-Dq24E4CF.js";import"./fast-deep-equal-BfsdOM8n.js";import"./json-schema-traverse-CSPPDTu_.js";import"./fast-uri-DB0GTO5Q.js";import"./scheduler-DhxmCZ7v.js";import"./@remix-run-BGIWjZ3f.js";import"./use-sync-external-store-HS-WvdAz.js";import"./nanoid-BV3C3NLD.js";import"./markdown-to-jsx-4MOCfVpk.js";import"./ajv-formats-B7rDf6Ua.js";import"./json-schema-compare-81NA3FRX.js";import"./compute-lcm-DluO9b7R.js";import"./compute-gcd-C3gVrxBz.js";import"./validate.io-array-K7AlgBFX.js";import"./validate.io-integer-array-CDpatKg4.js";import"./validate.io-integer-Dqa_6kz1.js";import"./validate.io-number-E8555gXQ.js";import"./validate.io-function-CsX-6D6V.js";import"./state-local-BC9ybJZH.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const z=e.createContext({theme:"default",updateTheme:e=>{}}),H=({children:s})=>{const[a,l]=e.useState(localStorage.getItem("theme")||"default");return t.jsx(z.Provider,{value:{theme:a,updateTheme:e=>{l(e),localStorage.setItem("theme",e)}},children:s})},J=o((e=>({slots:{},isEditing:!0,selectedSlot:null,selectedBlock:null,setSlots:t=>e({slots:t}),addBlockToSlot:(t,s)=>e((e=>({slots:{...e.slots,[t]:[...e.slots[t]||[],s]}}))),setSelectedSlot:t=>e({selectedSlot:t}),setSelectedBlock:t=>e({selectedBlock:t}),removeBlock:(t,s)=>e((e=>({slots:{...e.slots,[s]:e.slots[s].filter((e=>e.id!==t))}}))),deselectBlock:()=>e({selectedBlock:null}),moveBlock:(t,s,a)=>e((e=>{const l=[...e.slots[s]||[]],o=l.findIndex((e=>e.id===t));if(-1===o)return e;const r="up"===a?o-1:o+1;if(r<0||r>=l.length)return e;const[n]=l.splice(o,1);return l.splice(r,0,n),{slots:{...e.slots,[s]:l}}})),setBlockData:(t,s)=>e((e=>{const a={...e.slots};return Object.keys(a).forEach((e=>{a[e]=a[e].map((e=>e.id===t?{...e,data:s}:e))})),{slots:a}}))}))),W={},Q=function(e,t,s){let a=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),s=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));a=Promise.all(t.map((e=>{if((e=function(e){return"/"+e}(e))in W)return;W[e]=!0;const t=e.endsWith(".css"),a=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${a}`))return;const l=document.createElement("link");return l.rel=t?"stylesheet":"modulepreload",t||(l.as="script",l.crossOrigin=""),l.href=e,s&&l.setAttribute("nonce",s),document.head.appendChild(l),t?new Promise(((t,s)=>{l.addEventListener("load",t),l.addEventListener("error",(()=>s(new Error(`Unable to preload CSS for ${e}`))))})):void 0})))}return a.then((()=>e())).catch((e=>{const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}))},K={MainDashboard:{id:"MainDashboard",component:s.lazy((()=>Q((()=>import("./MainDashboard-C5kJiRXE.js")),__vite__mapDeps([0,1,2,3,4,5])))),slots:["header","primaryContent","footer"],parentSlots:["header","footer"]},layout2:{id:"layout2",component:s.lazy((()=>Q((()=>import("./Layout2-BONwQNPK.js")),__vite__mapDeps([6,1,2,3,4,5])))),slots:["header","primaryContent","footer"],parentSlots:["header","footer"]}},G={},X=e=>!e||e.endsWith(".")?()=>{}:(G[e]||(G[e]=t=>{try{return e.split(".").reduce(((e,t)=>e?e[t]:void 0),t)}catch{return}}),G[e]),Y=o(((e,t)=>({pageData:{},initialScope:{},selectedLayoutName:Object.keys(K)[0],setSelectedLayoutName:t=>{e((e=>({selectedLayoutName:t,pageData:{...e.pageData,layout:t}})))},updateField:(s,a)=>{const l={...t().pageData},o=((e,t,s)=>t.reduceRight(((s,a,l)=>{if(isNaN(Number(a)))return{...X(t.slice(0,l).join("."))(e),[a]:s};const o=X(t.slice(0,l).join("."))(e)||[];return o[Number(a)]=s,o}),s))(l,s.split("."),a);e({pageData:{...l,...o}})},getFieldValue:e=>X(e)(t().pageData)??"",resetPage:()=>e({pageData:{}})}))),Z=()=>null,ee=e=>{const{schema:s,id:a,options:l,value:o,type:n,placeholder:i,required:c,disabled:d,readonly:m,autofocus:u,formContext:p,hideError:b,hideLabel:h,uiSchema:j,rawErrors:x,onChange:g,onChangeOverride:f,...v}=e,k={...v,...r(s,n,l)};return t.jsx("input",{id:a,className:"w-full input input-bordered my-sm",autoFocus:u,value:o,onChange:f||(({target:{value:e}})=>{g(""===e?l.emptyValue||"":e)}),type:n,placeholder:i,disabled:d,readOnly:m,required:c,...k})},te=e=>{const{id:s,options:a,value:l,required:o,disabled:r,readonly:n,autofocus:i,placeholder:c,onChange:d,onBlur:m,onFocus:u,rawErrors:p=[]}=e;return t.jsxs("div",{className:"my-select-wrapper",children:[t.jsxs("select",{id:s,className:"select select-bordered w-full my-sm",value:l||"",required:o,disabled:r||n,autoFocus:i,onChange:e=>{const{value:t}=e.target;d(""===t?a.emptyValue:t)},onBlur:m&&(e=>m(s,e.target.value)),onFocus:u&&(e=>u(s,e.target.value)),children:[c&&t.jsx("option",{value:"",children:c}),(a.enumOptions||[]).map((({value:e,label:s},a)=>t.jsx("option",{value:e,children:s},a)))]}),p.length>0&&t.jsx("div",{className:"text-red-600 text-sm mt-2",children:p.join(", ")})]})};function se(e){const{canAdd:s,items:a,onAddClick:l}=e;return t.jsxs("div",{className:"mb-sm",children:[a.map(((e,s)=>t.jsxs("div",{className:"array-item",children:[t.jsx("div",{className:"border-l-8 pl-1 border-primary-content -ml-sm",children:e.children}),t.jsxs("div",{className:"flex justify-end gap-1 mb-sm",children:[e.hasMoveUp&&t.jsx("button",{type:"button",className:"btn btn-sm btn-outline",onClick:e.onReorderClick(e.index,e.index-1),children:"Move Up"}),e.hasMoveDown&&t.jsx("button",{type:"button",className:"btn btn-sm btn-outline",onClick:e.onReorderClick(e.index,e.index+1),children:"Move Down"}),e.hasRemove&&t.jsx("button",{type:"button",className:"btn btn-sm btn-danger",onClick:e.onDropIndexClick(e.index),children:"Remove"})]})]},s))),s&&t.jsx("button",{type:"button",className:"btn btn-primary btn-sm w-full mt-sm",onClick:l,children:"Add Item"})]})}function ae(e){const{description:s,id:a}=e;return t.jsx("div",{id:a,className:"text-xs text-neutral pt-1",children:s})}function le(e){const{id:s,help:a,required:l,description:o,errors:r,children:n,schema:i}=e;return t.jsxs("div",{className:`${2===s.split("_").length&&"border-b px-sm mb-sm"}  border-base-300`,children:[i.label&&i.type&&t.jsxs("label",{htmlFor:s,className:"form-label",children:[i.label,l&&t.jsx("span",{className:"text-danger",children:"*"})]}),o&&t.jsx(t.Fragment,{children:o}),t.jsx(t.Fragment,{children:n}),r&&t.jsx("div",{className:"form-errors text-danger",children:r}),a&&t.jsx("div",{className:"form-help text-muted",children:a})]})}const oe=Object.assign({"../blocks/Header.tsx":()=>Q((()=>import("./Header-YQw4_MKI.js")),__vite__mapDeps([7,1,2,3,4,5])),"../blocks/Image.tsx":()=>Q((()=>import("./Image-Dr8ugytS.js")),__vite__mapDeps([8,1,2,3,4,5])),"../blocks/InputBlock.tsx":()=>Q((()=>import("./InputBlock-fyZlW53F.js")),__vite__mapDeps([9,1,2,3,4,5,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37])),"../blocks/Link.tsx":()=>Q((()=>import("./Link-BtfffzoU.js")),__vite__mapDeps([38,1,2,3,4,5,12,10,11,13,14])),"../blocks/ListBlock.tsx":()=>Q((()=>import("./ListBlock-DsZq4ZjQ.js")),__vite__mapDeps([39,1,2,3,4,5,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37])),"../blocks/Logo.tsx":()=>Q((()=>import("./Logo-CIUzQXMf.js")),__vite__mapDeps([40,1,2,3,4,5])),"../blocks/Paragraph.tsx":()=>Q((()=>import("./Paragraph-EPALh4Pu.js")),__vite__mapDeps([41,1,2,3,4,5])),"../blocks/QueryBlock.tsx":()=>Q((()=>import("./QueryBlock-oWiM60HW.js")),__vite__mapDeps([42,1,2,3,4,5,34,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,35,36,37])),"../blocks/SelectBlock.tsx":()=>Q((()=>Promise.resolve().then((()=>ce))),void 0),"../blocks/SubmitForm.tsx":()=>Q((()=>import("./SubmitForm-CE8sSlml.js")),__vite__mapDeps([43,1,2,3,4,5,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37]))}),re=[{id:"fad8f7d6-2302-4772-ac5f-8a792b000c8d",filename:"Header",jsonSchema:{title:"Header Block",properties:{text:{type:"string",label:"Header Text"},className:{type:"string",label:"CSS Class"}}},icon:t.jsx(c,{}),group:"content",data:{text:"Default Header",className:"header-class"}},{id:"3b6883c2-4cd2-40f0-8bb9-63223362bf9e",filename:"Paragraph",jsonSchema:{title:"Paragraph Block",properties:{text:{type:"string",label:"Paragraph Text"},className:{type:"string",label:"CSS Class"}}},icon:t.jsx(d,{}),group:"content",data:{text:"Default paragraph text.",className:"paragraph-class"}},{id:"d1e9bb07-0b85-4860-bf19-0ec647c6f8b7",filename:"Image",jsonSchema:{title:"Image Block",properties:{url:{type:"string",label:"Image URL"},className:{type:"string",label:"CSS Class"}}},icon:t.jsx(m,{}),group:"content",data:{url:"https://via.placeholder.com/150",className:"image-class"}},{id:"bc0d1b89-f8b0-48b9-8978-1f7ed1c5e5c9",filename:"Link",jsonSchema:{title:"Link Block",properties:{name:{type:"string",label:"Link Text"},to:{type:"string",label:"Link URL"},className:{type:"string",label:"CSS Class"}}},icon:t.jsx(u,{}),group:"content",data:{name:"Link",to:"/",className:"link-class"}},{id:"9c8fd44a-b4d2-4b6d-a9ab-d8ac6d52d44c",filename:"Logo",jsonSchema:{title:"Logo Block",properties:{className:{type:"string",label:"CSS Class"}}},icon:t.jsx(c,{}),group:"content",data:{className:"logo-class"}},{id:"b8a6f7a8-7f84-4cbe-b8e6-245a72b9cfa6",filename:"ListBlock",jsonSchema:{title:"List Block",properties:{path:{type:"string",label:"Path to Data",description:"Path to data in pageStore, should point to an array."},repeater:{type:"array",label:"Repeater Fields",items:{type:"object",properties:{label:{type:"string",label:"Label for Data Field"},key:{type:"string",label:"Key for Data Field"}}}},className:{type:"string",label:"CSS Class",description:"CSS class for the list component."}}},icon:t.jsx(p,{}),group:"data",data:{path:"data.items",repeater:[{label:"Name",key:"name"},{label:"Description",key:"description"}],className:"list-component-class"}},{id:"query",filename:"QueryBlock",icon:t.jsx(b,{}),group:"data",jsonSchema:{title:"Query Block",properties:{model:{type:"string",label:"Model",description:"The API endpoint to fetch data from.",default:"document"},slug:{type:"string",label:"Slug",description:"The API endpoint to fetch data from.",default:"index"},successPath:{type:"string",label:"Success Path",description:"Path in pageStore where the fetched data will be stored."},errorPath:{type:"string",label:"Error Path",description:"Path in pageStore where the error message will be stored (optional)."}},required:["endpoint","successPath"]},data:{}},{id:"unique-select-block-id",filename:"SelectBlock",jsonSchema:{title:"Select Block",properties:{label:{type:"string",label:"Select Label"},fieldName:{type:"string",label:"Field Name"},options:{type:"array",label:"Options",items:{type:"object",properties:{label:{type:"string",label:"Option Label"},value:{type:"string",label:"Option Value"}}},description:"Array of options for the select input"},className:{type:"string",label:"CSS Class"}}},icon:t.jsx(h,{}),group:"data",data:{label:"Select an Option",fieldName:"selectField",options:[{label:"Option 1",value:"option1"},{label:"Option 2",value:"option2"},{label:"Option 3",value:"option3"}],className:"select-class"}},{id:"8d6a0d21-e548-4f0c-bb8a-4ae456479b68",filename:"InputBlock",jsonSchema:{title:"Input Block",properties:{label:{type:"string",label:"Input Label"},fieldName:{type:"string",label:"Field Name"},className:{type:"string",label:"CSS Class"}}},icon:t.jsx(j,{}),group:"data",data:{label:"Input Label",fieldName:"inputField",className:"input-class"}},{id:"6744c21b-5194-4a58-833a-341d8b0ab31f",filename:"SubmitForm",jsonSchema:{title:"Submit Form",properties:{className:{type:"string",label:"CSS Class"},endpoint:{type:"string",label:"API Endpoint"},method:{type:"string",enum:["GET","POST","PUT","DELETE"],label:"HTTP Method"}}},icon:t.jsx(x,{}),group:"data",data:{className:"submit-button-class"}}],ne=()=>{const{selectedBlock:e,selectedSlot:s,setBlockData:a,removeBlock:l,moveBlock:o,deselectBlock:r}=J((e=>({selectedBlock:e.selectedBlock,selectedSlot:e.selectedSlot,setBlockData:e.setBlockData,removeBlock:e.removeBlock,moveBlock:e.moveBlock,deselectBlock:e.deselectBlock}))),c=P(),d=D();if(!e)return t.jsx("div",{className:"p-4",children:"No block selected"});const m=re.find((t=>t.filename===e.filename));if(!m)return t.jsx("div",{className:"p-4",children:"Block schema not found"});const u=m.jsonSchema,p={SelectWidget:te};return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"sticky top-0 flex bg-base-100 items-center justify-between border-b border-base-300 px-md py-sm",children:[t.jsx("button",{className:"btn btn-circle btn-outline btn-xs",onClick:()=>{r();const e=new URLSearchParams(d.search);e.delete("rightbar"),c({pathname:d.pathname,search:e.toString()})},children:t.jsx(g,{})}),t.jsx("h3",{className:"text-2xl",children:e.filename})]}),t.jsx(n,{schema:u,validator:i,formData:e.data,onChange:e=>{},onBlur:t=>{var s;const l=null==(s=t.target)?void 0:s.closest("form"),o=new FormData(l),r=Object.fromEntries(o.entries());a(e.id,r)},uiSchema:{"ui:submitButtonOptions":{norender:!0}},templates:{BaseInputTemplate:ee,TitleFieldTemplate:Z,ArrayFieldTemplate:se,DescriptionFieldTemplate:ae,FieldTemplate:le},widgets:p}),t.jsxs("div",{className:"flex gap-2 p-md border-b border-base-300",children:[t.jsxs("button",{className:"btn btn-outline btn-sm",onClick:()=>s&&o(e.id,s,"up"),children:[t.jsx(f,{})," Move Up"]}),t.jsxs("button",{className:"btn btn-outline btn-sm",onClick:()=>s&&o(e.id,s,"down"),children:[t.jsx(v,{})," Move Down"]}),t.jsxs("button",{className:"btn btn-outline btn-sm text-red-600",onClick:()=>s&&l(e.id,s),children:[t.jsx(k,{})," Delete Block"]})]})]})},ie=({label:e,fieldName:s,options:a=[]})=>{const l=Y((e=>e.updateField)),o=Y((e=>e.getFieldValue(s)))||"";return t.jsxs("div",{children:[t.jsx("label",{className:"block pb-sm ",children:e}),t.jsx("select",{className:"select select-bordered w-full mb-2",value:o,onChange:e=>{l(s,e.target.value)},children:a.map((e=>t.jsx("option",{value:e.value,children:e.label},e.value)))})]})},ce=Object.freeze(Object.defineProperty({__proto__:null,SelectBlock:ie,default:ie},Symbol.toStringTag,{value:"Module"})),de={users:"user",workspaces:"workspace",documents:"document",categories:"category",documentCategories:"documentCategory",files:"file",courseLevels:"courseLevel",courseObjectives:"courseObjective",courseTitles:"courseTitle",unitTitles:"unitTitle",subjects:"subject",lessonStrategies:"lessonStrategy",pools:"pool"},me=()=>{const e=(()=>{const e="auth_token=",t=decodeURIComponent(document.cookie).split(";");for(const s of t){const t=s.trim();if(t.startsWith(e))return t.substring(11)}return null})();return{"Content-Type":"application/json",...e&&{Authorization:`Bearer ${e}`}}},ue=async(e,t)=>{if(!e.ok){const t=await e.json();throw new Error(JSON.stringify(t))}return e.json()},pe=async(e,t)=>{const s=`http://localhost:3004/${e}/slug/${t}`,a=await fetch(s);return ue(a)},be=({model:e,setSelectedItem:t,setErrorMessage:s})=>{const a=A(),l=()=>{a.invalidateQueries({queryKey:[e]}),t(null),s(null)},o=e=>{e instanceof Error?s(e.message):s("An unexpected error occurred.")},r=q({mutationFn:t=>(async(e,t)=>{const s=de[e]||"",a=await fetch(`http://localhost:3004/${s}`,{method:"POST",headers:me(),body:JSON.stringify(t)});return ue(a)})(e||"",t),onSuccess:l,onError:o}),n=q({mutationFn:({id:t,item:s})=>(async(e,t,s)=>{const a=de[e]||"",l=await fetch(`http://localhost:3004/${a}/${t}`,{method:"PUT",headers:me(),body:JSON.stringify(s)});return ue(l)})(e||"",t,s),onSuccess:l,onError:o}),i=q({mutationFn:({model:e,slug:t,slot:s,content:a})=>(async(e,t,s,a)=>{const l=`http://localhost:3004/${e}/slug/${t}/content`,o=await fetch(l,{method:"PUT",headers:me(),body:JSON.stringify({key:s,value:a})});return ue(o)})(e,t,s,a),onSuccess:l,onError:o});return{createMutation:r,updateMutation:n,deleteMutation:q({mutationFn:t=>(async(e,t)=>{const s=de[e]||"",a=await fetch(`http://localhost:3004/${s}/${t}`,{method:"DELETE",headers:me()});return ue(a)})(e||"",t),onSuccess:l,onError:o}),updateContentMutation:i}},he=()=>{const{workspace:s,slug:a}=O(),[l,o]=e.useState(null),{updateContentMutation:r}=be({model:"content",setSelectedItem:()=>{},setErrorMessage:o}),{selectedSlot:n,addBlockToSlot:i,slots:c}=J((e=>({selectedSlot:e.selectedSlot,addBlockToSlot:e.addBlockToSlot,slots:e.slots}))),{layout:d}=Y((e=>({layout:e.pageData.layout}))),[m,u]=e.useState("content"),p=re.reduce(((e,t)=>{const s=t.group||"others";return e[s]||(e[s]=[]),e[s].push(t),e}),{}),b=Object.keys(K).map((e=>({label:e.charAt(0).toUpperCase()+e.slice(1),value:e})));return t.jsxs("div",{className:"w-80 bg-base-200 h-full flex flex-col",children:[t.jsx("div",{className:"px-md py-sm border-b border-base-300",children:t.jsx("h1",{className:"text-xl font-black m-0.5",children:"Content Blocks Editor"})}),t.jsx("div",{className:"p-md border-b border-base-300",children:t.jsx(ie,{label:"Choose layout:",fieldName:"layout",options:b})}),t.jsx("div",{className:" border-b border-base-300",children:t.jsx("label",{className:"block p-md",children:"Choose block:"})}),t.jsx("div",{className:"tabs tabs-bordered bg-base-300",children:Object.keys(p).map((e=>t.jsx("button",{className:"tab "+(m===e?"tab-active bg-base-100":""),onClick:()=>u(e),children:e.charAt(0).toUpperCase()+e.slice(1)},e)))}),t.jsx("div",{className:" border-b border-base-300",children:t.jsx("div",{className:"grid grid-cols-2 gap-sm p-md",children:p[m].map((e=>t.jsxs("button",{className:"btn btn-md btn-outline w-full no-animation font-light",onClick:()=>(e=>{if(n){const t={id:U(),filename:e,data:{},icon:void 0};i(n,t)}else alert("Please select a slot first.")})(e.filename),children:[t.jsx("div",{className:"text-lg",children:e.icon}),t.jsx("div",{className:"text-sm text-left flex-1",children:e.jsonSchema.title})]},e.id)))})}),t.jsx("div",{className:"flex-1"}),t.jsxs("div",{className:"p-md border-t border-base-300",children:[t.jsx("span",{className:" font-semibold",children:"Selected Slot: "}),t.jsx("span",{children:n||"No slot selected"}),l&&t.jsx("div",{className:"text-error",children:l}),n&&t.jsx("button",{onClick:()=>(()=>{if(n){const e=K[d].parentSlots.includes(n),t=e?s:a;if(!t)return void o("Slug is undefined. Cannot save content.");r.mutate({model:e?"workspace":"document",slug:t,slot:n,content:c[n]})}else alert("No slot selected to save.")})(),className:"btn btn-md btn-outline w-full no-animation font-light mt-sm",children:"Save selected slot data"})]})]})},je=({context:e,content:s})=>t.jsxs("div",{className:`${e&&"drawer lg:drawer-open"}`,children:[e&&t.jsx("input",{id:"my-drawer-2",type:"checkbox",className:"drawer-toggle"}),t.jsxs("div",{className:"drawer-content",children:[s,t.jsx("label",{htmlFor:"my-drawer-2",className:"btn btn-primary drawer-button lg:hidden",children:"Open drawer"})]}),e&&t.jsxs("div",{className:"drawer-side",children:[t.jsx("label",{htmlFor:"my-drawer-2","aria-label":"close sidebar",className:"drawer-overlay"}),e]}),"|"]}),xe=({theme:e,handleThemeChange:s})=>t.jsx("div",{className:"join join-vertical w-full",children:["default","light","dark","cupcake","aqua","retro","cyberpunk","pastel","nord"].map((a=>t.jsx("input",{type:"radio",name:"theme-buttons",className:"btn theme-controller join-item btn-sm font-thin","aria-label":a.charAt(0).toUpperCase()+a.slice(1),value:a,checked:e===a,onChange:s},a)))}),ge=()=>{const e=P(),s=D(),{workspace:a,slug:l,action:o}=O(),r=s.pathname.endsWith(`/${a}/${l}/`);return t.jsxs(t.Fragment,{children:[t.jsx("button",{className:"btn btn-sm btn-square "+("edit-side"===o?"btn-active":""),onClick:()=>e(`/${a}/${l}/edit-side/`),children:t.jsx(y,{})}),t.jsx("button",{className:"btn btn-sm btn-square "+("edit-workspace"===o?"btn-active":""),onClick:()=>e(`/${a}/${l}/edit-workspace/`),children:t.jsx(N,{})}),t.jsx("button",{className:"btn btn-sm btn-square "+("edit-document"===o?"btn-active":""),onClick:()=>e(`/${a}/${l}/edit-document/`),children:t.jsx(S,{})}),t.jsx("button",{className:"btn btn-sm btn-square "+("edit-modal"===o?"btn-active":""),onClick:()=>e(`/${a}/${l}/edit-modal/`),children:t.jsx(w,{})}),t.jsx("button",{className:"btn btn-sm btn-square "+("edit-scope"===o?"btn-active":""),onClick:()=>e(`/${a}/${l}/edit-scope/`),children:t.jsx(C,{})}),t.jsx("button",{className:"btn btn-sm btn-square "+(r?"btn-active":""),onClick:()=>e(`/${a}/${l}/`),children:t.jsx(E,{})})]})},fe=()=>{const{theme:s,updateTheme:a}=e.useContext(z),l=P(),o=D();return t.jsxs("div",{className:"sticky top-0 p-sm px-md bg-base-300 text-xs z-20 flex gap-0.5 w-full border-b border-base-300 shadow-lg",children:[t.jsx("button",{className:"btn btn-sm btn-square",onClick:()=>l("/"),children:t.jsx(_,{})}),t.jsx(ge,{}),t.jsxs("div",{className:"dropdown",children:[t.jsx("div",{tabIndex:1,role:"button",className:"btn btn-sm btn-square",children:t.jsx(B,{})}),t.jsx("div",{tabIndex:1,className:"dropdown-content z-[1] w-52 pb-2",children:t.jsx(xe,{theme:s,handleThemeChange:e=>{a(e.target.value)}})})]}),t.jsx("div",{className:"flex-1"}),t.jsx("button",{className:"btn btn-sm btn-square",onClick:()=>{const e=new URLSearchParams(o.search);e.set("rightbar","user"),l({pathname:o.pathname,search:e.toString()})},children:t.jsx(L,{})})]})},ve=({label:s,value:a,isRequired:l,onChange:o})=>{const[r,n]=e.useState(null),i=JSON.stringify(a,null,2);return t.jsxs("div",{className:"json-editor",children:[t.jsxs("label",{className:"block p-md",children:[s," ",l&&t.jsx("span",{children:"*"})]}),t.jsx(V,{height:"calc(100vh - 280px)",language:"json",value:i,onChange:e=>{if(void 0!==e)try{const t=JSON.parse(e);n(null),o(t)}catch(t){n("Invalid JSON syntax")}},theme:"vs-dark",options:{minimap:{enabled:!1},lineNumbers:"on"}}),r&&t.jsx("p",{className:"alert alert-error rounded-none",children:r})]})},ke=()=>{const[s,a]=e.useState("initialScope"),l=Y((e=>e.initialScope)),o=Y((e=>e.pageData)),r=J((e=>e.slots));let n;return"initialScope"===s?n=l:"actualScope"===s?n=o:"slotsPreview"===s&&(n=r),t.jsxs("div",{className:"w-full",children:[t.jsxs("div",{className:"tabs tabs-lifted border-b border-base-200 mt-sm",children:[t.jsx("button",{className:"tab "+("initialScope"===s?"tab-active":""),onClick:()=>a("initialScope"),children:"Initial scope"}),t.jsx("button",{className:"tab "+("actualScope"===s?"tab-active":""),onClick:()=>a("actualScope"),children:"Actual Scope"}),t.jsx("button",{className:"tab "+("slotsPreview"===s?"tab-active":""),onClick:()=>a("slotsPreview"),children:"Slots Preview"})]}),t.jsx(ve,{id:"json-block-id",label:"initialScope"===s?"Page scope range":"actualScope"===s?"Actual page scope":"Slots Preview",value:n||{},isRequired:!0,onChange:e=>{}}),t.jsx("div",{className:"p-sm",children:t.jsx("button",{className:"btn btn-success btn-outline w-full",children:"Update page scope"})})]})},ye=({children:e})=>t.jsx("div",{className:"fixed right-0 top-0 max-w-1/3 min-w-96 h-full bg-base-100 z-50 border-l border-base-300 overflow-y-auto",children:e}),Ne=({block:s})=>{const[a,l]=e.useState(null);J((e=>e.isEditing));return e.useEffect((()=>{(async()=>{const e=oe[`../blocks/${s.filename}.tsx`];if(e){const t=await e();l((()=>t.default))}})()}),[s.filename]),a?t.jsx("div",{className:"",children:t.jsx(a,{...s.data})}):t.jsx(t.Fragment,{})},Se=({slots:e,slotName:s})=>e[s]?t.jsx(t.Fragment,{children:e[s].map((e=>t.jsx("div",{className:"block-wrapper",children:t.jsx(Ne,{block:e})},e.id)))}):t.jsxs("div",{children:["No content for ",s]}),we=({slots:e,slotName:s})=>{const{selectedSlot:a,selectedBlock:l,setSelectedSlot:o,setSelectedBlock:r,isEditing:n}=J(),i=D(),c=P();return e[s]?t.jsxs("div",{className:"border mb-4 p-1 "+(a===s?"border-dashed border-primary":"border-base-300"),onClick:()=>{if(n&&a!==s){o(s),r(null);const e=new URLSearchParams(i.search);e.delete("rightbar"),c({pathname:i.pathname,search:e.toString()})}},children:[t.jsx("div",{className:"slot-name text-sm mb-2 "+(a===s?"text-primary font-semibold":"text-base-content"),children:s}),e[s].map((e=>t.jsx("div",{className:"border border-dotted "+((null==l?void 0:l.id)===e.id?"bg-primary bg-opacity-20":"border-base-300"),onClick:t=>{t.stopPropagation(),(e=>{r(e),o(s);const t=new URLSearchParams(i.search);t.set("rightbar","block"),c({pathname:i.pathname,search:t.toString()})})(e)},children:t.jsx(Ne,{block:e})},e.id)))]}):t.jsxs("div",{children:["No content for ",s]})},Ce=()=>t.jsx("form",{className:"flex flex-col gap-sm",children:t.jsx(Se,{slots:{loginForm:[{id:"75f19de7-4bab-4343-99eb-80a81dc38306",filename:"InputBlock",data:{label:"User email",fieldName:"user.email",className:""}},{id:"9b7b7f4d-889c-440d-88ed-bf9f4920c256",filename:"InputBlock",data:{label:"Password",fieldName:"user.password",className:""}},{id:"5b8d9266-a445-425b-aae2-59aa0b181314",filename:"SubmitForm",data:{mutation:"SignInAction"}}]},slotName:"loginForm"})}),Ee=()=>{const{slots:s,setSlots:a}=J(),{action:l}=O(),o=D(),r=Y((e=>{var t;return null==(t=e.pageData)?void 0:t.layout})),{workspaceData:n,documentData:i,isWorkspaceLoading:c,isDocumentLoading:d,workspaceError:m,documentError:u}=(()=>{const{workspace:e,slug:t}=O(),{data:s,isLoading:a,error:l}=R({queryKey:["workspace",e],queryFn:()=>pe("workspace",e||"dashboard")}),{data:o,isLoading:r,error:n}=R({queryKey:["document",t],queryFn:()=>pe("document",t||"documents"),enabled:!!s});return{workspaceData:s,documentData:o,isWorkspaceLoading:a,isDocumentLoading:r,workspaceError:l,documentError:n}})();if(e.useEffect((()=>{var e;if(n){const{_pageData:t,...s}=n.workspace.content,l=((e,t)=>({...e,...t}))(s,(null==(e=null==i?void 0:i.document)?void 0:e.content)||{});a(l),Y.setState((()=>({pageData:t}))),(e=>{if(e){const t=K[e.layout]?e.layout:Object.keys(K)[0];Y.setState((s=>({...s,pageData:{...s.pageData,layout:t},initialScope:{...e}})))}})(t)}}),[n,i,a]),c||d)return null;if(m||u)return t.jsxs("div",{className:"text-error",children:["Error loading content: ",(null==m?void 0:m.message)||(null==u?void 0:u.message)]});const p=K[r]?r:Object.keys(K)[0],b=K[p];if(!b)return t.jsx("div",{className:"text-error",children:"Error: layout config not found"});const h=b.slots.reduce(((e,a)=>{const o="edit-scope"===l||"edit-document"===l||"edit-block"===l?we:Se;return e[a]=t.jsx(o,{slots:s,slotName:a}),e}),{}),j=new URLSearchParams(o.search).get("rightbar");return t.jsx(je,{context:l?t.jsx(he,{}):null,content:t.jsxs(t.Fragment,{children:[t.jsx(fe,{}),t.jsxs("div",{className:"flex items-stretch",children:["edit-scope"===l&&t.jsx("div",{className:"bg-base-300 w-2/5",children:t.jsx(ke,{})}),t.jsx("div",{className:"flex-1",children:t.jsx(e.Suspense,{fallback:t.jsx("div",{className:"text-gray-500",children:"Loading layout..."}),children:b.component&&t.jsx(b.component,{...h})})})]}),j&&t.jsxs(ye,{children:["user"===j&&t.jsx(Ce,{}),"block"===j&&t.jsx(ne,{})]})]})})},_e=new $,Be=({children:e})=>t.jsx(M,{client:_e,children:e}),Le=()=>t.jsx(H,{children:t.jsx(Be,{children:t.jsx(l,{children:t.jsxs(T,{children:[t.jsx(F,{path:"/",element:t.jsx(I,{to:"dashboard/documents/edit",replace:!0})}),t.jsx(F,{path:"/:workspace/:slug",element:t.jsx(Ee,{})}),t.jsx(F,{path:"/:workspace/:slug/:action",element:t.jsx(Ee,{})})]})})})});a.createRoot(document.getElementById("root")).render(t.jsx(s.StrictMode,{children:t.jsx(Le,{})}));export{Q as _,pe as f,X as g,Y as u};
